version: '3'

tasks:
  default:
    deps:
      - slurm
      - plug
      - plug.install

  slurm:
    desc: >
      SLURM syntax highlighting.
    cmd: >
      curl \
         --create-dirs --fail --location \
         --output {{.HOME}}/.vim/after/syntax/sh/'#1' \
         'https://raw.githubusercontent.com/SchedMD/slurm/master/contribs/slurm_completion_help/{slurm.vim}'
    generates:
      - "{{.HOME}}/.vim/after/syntax/sh/slurm.vim"

  plug:
    desc: >
      Intall plug.vim
    cmd: |
      curl \
         --create-dirs --fail --location \
         --output {{.HOME}}/.vim/autoload/plug.vim \
         https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

  plug.install:
    desc: >
      Trigger vim's Plug system to install plugins.
    deps:
      - plug
    cmd: >
      vim
        +:PlugInstall
        +:PlugUpdate
        "+:CocInstall coc-json"
        "+:CocInstall coc-yaml"
        "+:CocInstall coc-jedi"
        +:qall
